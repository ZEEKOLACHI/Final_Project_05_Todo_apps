<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Resume Analyzer â€” AI-Powered Resume Scorer</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Space+Mono:wght@700&display=swap" rel="stylesheet">
<style>
:root { --accent: #6C3CE1; --bg: #0D0D12; --card: #16161F; --border: #2A2A3A; --text: #E4E4EB; --muted: #8888A0; }
* { margin:0; box-sizing:border-box; }
body { font-family:'DM Sans',sans-serif; background:var(--bg); color:var(--text); min-height:100vh; }
.mono { font-family:'Space Mono',monospace; }
.glass { background:rgba(22,22,31,.85); backdrop-filter:blur(12px); border:1px solid var(--border); }
.glow { box-shadow: 0 0 40px rgba(108,60,225,.15); }
textarea { background:var(--card); border:1px solid var(--border); color:var(--text); resize:vertical; }
textarea:focus { outline:none; border-color:var(--accent); }
.score-ring { width:140px; height:140px; border-radius:50%; display:flex; align-items:center; justify-content:center; position:relative; }
.progress-bar { height:8px; border-radius:4px; background:var(--border); overflow:hidden; }
.progress-fill { height:100%; border-radius:4px; transition: width 1s ease; }
@keyframes fadeUp { from { opacity:0; transform:translateY(20px); } to { opacity:1; transform:translateY(0); } }
.fade-up { animation: fadeUp .5s ease forwards; }
.badge { display:inline-block; padding:2px 10px; border-radius:20px; font-size:12px; font-weight:500; }
</style>
</head>
<body>
<div class="max-w-5xl mx-auto px-4 py-8">
  <!-- Header -->
  <header class="text-center mb-10 fade-up">
    <div class="inline-block px-4 py-1 rounded-full text-xs font-medium mb-4" style="background:rgba(108,60,225,.15);color:#A78BFA;">HACKATHON 0 â€” SKILL 1</div>
    <h1 class="text-4xl md:text-5xl font-bold mono mb-3" style="color:var(--accent);">Resume Analyzer</h1>
    <p style="color:var(--muted);" class="text-lg">AI-powered resume scoring & ATS compatibility check</p>
  </header>

  <!-- Input Section -->
  <div class="grid md:grid-cols-2 gap-6 mb-8">
    <div class="glass rounded-2xl p-6 fade-up" style="animation-delay:.1s">
      <label class="block text-sm font-medium mb-2" style="color:var(--muted);">ğŸ“„ Paste Your Resume</label>
      <textarea id="resume" rows="12" class="w-full rounded-xl p-4 text-sm" placeholder="Paste your resume text here..."></textarea>
    </div>
    <div class="glass rounded-2xl p-6 fade-up" style="animation-delay:.2s">
      <label class="block text-sm font-medium mb-2" style="color:var(--muted);">ğŸ¯ Job Description (Optional)</label>
      <textarea id="jobDesc" rows="12" class="w-full rounded-xl p-4 text-sm" placeholder="Paste the target job description for keyword matching..."></textarea>
    </div>
  </div>

  <div class="text-center mb-10">
    <button onclick="analyzeResume()" id="analyzeBtn" class="px-8 py-3 rounded-xl font-bold text-white text-lg transition-all hover:scale-105" style="background:var(--accent);">
      âš¡ Analyze Resume
    </button>
  </div>

  <!-- Results (hidden initially) -->
  <div id="results" class="hidden">
    <!-- Score Card -->
    <div class="glass rounded-2xl p-8 mb-6 glow fade-up flex flex-col md:flex-row items-center gap-8">
      <div class="score-ring" id="scoreRing">
        <div class="text-center">
          <div class="mono text-4xl font-bold" id="scoreNum" style="color:var(--accent);">0</div>
          <div class="text-xs" style="color:var(--muted);">/100</div>
        </div>
      </div>
      <div class="flex-1">
        <h2 class="text-2xl font-bold mb-1" id="scoreLabel">Analyzing...</h2>
        <p class="text-sm mb-4" style="color:var(--muted);" id="scoreSummary"></p>
        <div class="flex flex-wrap gap-2" id="badges"></div>
      </div>
    </div>

    <!-- Section Scores -->
    <div class="grid md:grid-cols-2 gap-4 mb-6" id="sections"></div>

    <!-- Suggestions -->
    <div class="glass rounded-2xl p-6 mb-6 fade-up">
      <h3 class="text-lg font-bold mb-4">ğŸ’¡ Improvement Suggestions</h3>
      <div id="suggestions" class="space-y-3"></div>
    </div>

    <!-- Keywords -->
    <div class="glass rounded-2xl p-6 fade-up" id="keywordsCard" style="display:none;">
      <h3 class="text-lg font-bold mb-4">ğŸ”‘ Keyword Match Analysis</h3>
      <div class="flex flex-wrap gap-2" id="keywords"></div>
    </div>
  </div>
</div>

<script>
function analyzeResume() {
  const resume = document.getElementById('resume').value.trim();
  const jobDesc = document.getElementById('jobDesc').value.trim();
  if (!resume) { alert('Please paste your resume text!'); return; }

  document.getElementById('analyzeBtn').textContent = 'â³ Analyzing...';
  document.getElementById('analyzeBtn').disabled = true;

  setTimeout(() => {
    const analysis = performAnalysis(resume, jobDesc);
    displayResults(analysis);
    document.getElementById('analyzeBtn').textContent = 'âš¡ Analyze Resume';
    document.getElementById('analyzeBtn').disabled = false;
  }, 1500);
}

function performAnalysis(resume, jobDesc) {
  const lower = resume.toLowerCase();
  // Fix 1: accurate word count â€” strip punctuation then filter empty tokens
  const words = resume.split(/\s+/).filter(w => w.replace(/[^a-zA-Z0-9]/g,'').length > 0).length;
  const lines = resume.split('\n').filter(l => l.trim()).length;

  // Section detection
  const hasContact = /email|phone|linkedin|github|portfolio/i.test(resume);
  const hasExperience = /experience|work history|employment/i.test(resume);
  const hasEducation = /education|degree|university|bachelor|master/i.test(resume);
  const hasSkills = /skills|technologies|tools|proficient/i.test(resume);
  const hasSummary = /summary|objective|profile|about/i.test(resume);
  const hasProjects = /project|portfolio|built|developed/i.test(resume);

  // Scoring â€” Fix 2: format score uses corrected word threshold
  const scores = {
    contact: hasContact ? 85 + Math.floor(Math.random()*15) : 20,
    experience: hasExperience ? 70 + Math.floor(Math.random()*25) : 15,
    education: hasEducation ? 75 + Math.floor(Math.random()*20) : 20,
    skills: hasSkills ? 80 + Math.floor(Math.random()*15) : 25,
    format: words > 120 && words < 900 ? 85 : words > 80 ? 60 : 30,
    impact: /increased|improved|reduced|achieved|delivered|built|led|managed/i.test(resume) ? 80 + Math.floor(Math.random()*15) : 35,
  };

  const overall = Math.round(Object.values(scores).reduce((a,b)=>a+b,0) / Object.keys(scores).length);

  // Fix 3: expanded stop words list to filter non-skill words
  const stopWords = new Set([
    'the','and','for','with','that','this','from','are','was','have','has','will','been',
    'they','their','your','which','about','into','than','also','some','more','other','each',
    'such','when','very','just','like','only','must','should','would','could','need','able',
    'work','working','looking','strong','good','great','well','high','level','using','used',
    'help','team','role','join','make','take','build','lead','our','you','who','what','how',
    'its','all','any','new','can','get','not','but','may','etc','per','via','both','least',
    'company','position','candidate','applicant','required','preferred','plus','bonus',
    'including','following','related','relevant','various','multiple','across','within',
    'between','through','over','under','along','around','every','many','most','much',
    'knowledge','understanding','familiarity','proficiency','ability','skills','proven',
    'demonstrated','excellent','exceptional','solid','deep','broad','extensive','hands',
  ]);

  // Fix 4: extract meaningful tech keywords using word-boundary tokenization from full JD
  // Prioritise multi-word tech terms first (e.g. "ci/cd", "node.js"), then single words
  let keywordResults = [];
  if (jobDesc) {
    const jdLower = jobDesc.toLowerCase();

    // Extract compound tech tokens (with dots, slashes, plus signs, hash)
    const compoundTokens = [...new Set(jdLower.match(/\b[\w]+(?:[./#+][\w]+)+\b/g) || [])];

    // Extract regular words (min length 3, letters only) â€” >= 3 to include aws, gcp etc
    const singleTokens = [...new Set(jdLower.match(/\b[a-z]{3,}\b/g) || [])];

    // Filter single tokens: remove stop words, require length >= 3
    const filteredSingle = singleTokens.filter(w => !stopWords.has(w) && w.length >= 3);

    // Combine: compound tokens first, then single words, deduplicated
    const allKeywords = [...new Set([...compoundTokens, ...filteredSingle])];

    // Fix 5: word-boundary match â€” prevents "java" matching inside "javascript"
    const matchKeyword = (kw) => {
      // For compound tokens (node.js, ci/cd) use escaped regex
      const escaped = kw.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      return new RegExp('(?:^|[\\s,/|&()])' + escaped + '(?=[\\s,/|&().!?]|$)').test(lower);
    };

    // Take up to 50 keywords to cover full JD
    const top50 = allKeywords.slice(0, 50);
    keywordResults = top50.map(kw => ({ keyword: kw, found: matchKeyword(kw) }));
  }

  // Suggestions
  const suggestions = [];
  if (!hasContact) suggestions.push({ icon:'ğŸ“§', text:'Add contact information (email, phone, LinkedIn URL)' });
  if (!hasSummary) suggestions.push({ icon:'ğŸ“', text:'Add a professional summary or objective section at the top' });
  if (!hasExperience) suggestions.push({ icon:'ğŸ’¼', text:'Include a work experience section with dates and descriptions' });
  if (!hasSkills) suggestions.push({ icon:'ğŸ› ï¸', text:'Add a skills section listing your technical and soft skills' });
  if (!hasProjects) suggestions.push({ icon:'ğŸš€', text:'Consider adding a projects section to showcase your work' });
  if (!/\d+%|\d+ percent|increased|reduced by/i.test(resume)) suggestions.push({ icon:'ğŸ“Š', text:'Add quantifiable achievements (e.g., "Increased sales by 30%")' });
  // Fix 6: corrected word-count thresholds
  if (words < 120) suggestions.push({ icon:'ğŸ“', text:'Resume seems short. Consider expanding your experience descriptions' });
  if (words > 900) suggestions.push({ icon:'âœ‚ï¸', text:'Resume may be too long. Keep it concise â€” 1-2 pages max' });
  // Fix 7: suggest adding missing JD keywords if match rate is low
  if (keywordResults.length > 0) {
    const missed = keywordResults.filter(k => !k.found).map(k => k.keyword);
    const matchRate = (keywordResults.length - missed.length) / keywordResults.length;
    if (matchRate < 0.5 && missed.length > 0) {
      const missedSample = missed.slice(0, 5).join(', ');
      suggestions.push({ icon:'ğŸ”‘', text:`Low keyword match with job description. Consider adding: ${missedSample}` });
    }
  }
  if (suggestions.length === 0) suggestions.push({ icon:'ğŸ‰', text:'Great resume! Consider tailoring keywords to each specific job posting' });

  return { overall, scores, suggestions, keywordResults, words, lines };
}

function displayResults(a) {
  document.getElementById('results').classList.remove('hidden');

  // Score
  const el = document.getElementById('scoreNum');
  let current = 0;
  const interval = setInterval(() => {
    current += 2;
    if (current >= a.overall) { current = a.overall; clearInterval(interval); }
    el.textContent = current;
  }, 20);

  const ring = document.getElementById('scoreRing');
  const color = a.overall >= 80 ? '#22C55E' : a.overall >= 60 ? '#EAB308' : a.overall >= 40 ? '#F97316' : '#EF4444';
  ring.style.background = `conic-gradient(${color} ${a.overall*3.6}deg, var(--border) 0deg)`;

  document.getElementById('scoreLabel').textContent = a.overall >= 80 ? 'ğŸ† Excellent Resume!' : a.overall >= 60 ? 'ğŸ‘ Good â€” Needs Minor Improvements' : a.overall >= 40 ? 'âš ï¸ Average â€” Several Areas Need Work' : 'ğŸ”´ Needs Significant Improvement';
  document.getElementById('scoreSummary').textContent = `${a.words} words Â· ${a.lines} lines Â· ${Object.values(a.scores).filter(s=>s>=70).length}/6 sections strong`;

  // Badges
  const badges = document.getElementById('badges');
  badges.innerHTML = '';
  if (a.overall >= 80) badges.innerHTML += '<span class="badge" style="background:rgba(34,197,94,.15);color:#22C55E;">ATS Ready</span>';
  if (a.scores.impact >= 70) badges.innerHTML += '<span class="badge" style="background:rgba(108,60,225,.15);color:#A78BFA;">Impact-Driven</span>';
  if (a.words >= 300 && a.words <= 700) badges.innerHTML += '<span class="badge" style="background:rgba(59,130,246,.15);color:#60A5FA;">Ideal Length</span>';

  // Sections
  const sectionNames = { contact:'ğŸ“§ Contact Info', experience:'ğŸ’¼ Experience', education:'ğŸ“ Education', skills:'ğŸ› ï¸ Skills', format:'ğŸ“ Format & Length', impact:'ğŸ“Š Impact Metrics' };
  const sectionsEl = document.getElementById('sections');
  sectionsEl.innerHTML = '';
  for (const [key, score] of Object.entries(a.scores)) {
    const c = score >= 80 ? '#22C55E' : score >= 60 ? '#EAB308' : '#EF4444';
    sectionsEl.innerHTML += `
      <div class="glass rounded-xl p-4 fade-up">
        <div class="flex justify-between mb-2"><span class="text-sm font-medium">${sectionNames[key]}</span><span class="mono text-sm font-bold" style="color:${c}">${score}</span></div>
        <div class="progress-bar"><div class="progress-fill" style="width:${score}%;background:${c};"></div></div>
      </div>`;
  }

  // Suggestions
  const sugEl = document.getElementById('suggestions');
  sugEl.innerHTML = a.suggestions.map(s => `<div class="flex gap-3 items-start p-3 rounded-lg" style="background:var(--card);"><span class="text-xl">${s.icon}</span><span class="text-sm">${s.text}</span></div>`).join('');

  // Keywords
  if (a.keywordResults.length > 0) {
    document.getElementById('keywordsCard').style.display = 'block';
    const kwEl = document.getElementById('keywords');
    kwEl.innerHTML = a.keywordResults.map(k =>
      `<span class="badge" style="background:${k.found ? 'rgba(34,197,94,.15)' : 'rgba(239,68,68,.15)'};color:${k.found ? '#22C55E' : '#EF4444'};">${k.found ? 'âœ“' : 'âœ—'} ${k.keyword}</span>`
    ).join('');
  }

  document.getElementById('results').scrollIntoView({ behavior:'smooth', block:'start' });
}
</script>
</body>
</html>
